import{d as s,g as e,l as a,s as l,m as t,o as u,j as r,b as d,w as o,a as c,u as n,c as i,e as p,t as f,F as m,r as v,v as _,n as y,B as g,ab as b,h as x,f as k,k as I,X as h,I as j,S as w,i as F}from"./index-d6eea5d2.js";import{g as P,a as T,b as A,p as C}from"./order.69ed94f8.js";import{u as M}from"./address.f9892280.js";import{_ as V}from"./_plugin-vue_export-helper.1b428a4d.js";import"./http.2ff40c52.js";const B=V(s({__name:"create",props:{skuId:null,count:null,orderId:null},setup(s){const V=s,{safeAreaInsets:B}=e(),$=a(""),D=a([{type:1,text:"时间不限 (周一至周日)"},{type:2,text:"工作日送 (周一至周五)"},{type:3,text:"周末配送 (周六至周日)"}]),L=a(0),O=l((()=>D.value[L.value])),S=s=>{L.value=s.detail.value},U=a();t((()=>{(async()=>{if(V.count&&V.skuId){const s=await P({count:V.count,skuId:V.skuId});U.value=s.result}else if(V.orderId){const s=await T(V.orderId);U.value=s.result}else{const s=await A();U.value=s.result}})()}));const X=M(),q=l((()=>{var s;return X.selectedAddress||(null==(s=U.value)?void 0:s.userAddresses.find((s=>s.isDefault)))})),z=async()=>{var s,e;if(!(null==(s=q.value)?void 0:s.id))return g({icon:"none",title:"请选择收货地址"});const a=await C({addressId:null==(e=q.value)?void 0:e.id,buyerMessage:$.value,deliveryTimeType:O.value.type,goods:U.value.goods.map((s=>({count:s.count,skuId:s.skuId}))),payChannel:2,payType:1});b({url:`/pagesOrder/detail/detail?id=${a.result.id}`})};return(s,e)=>{var a;const l=x,t=k,g=I,b=F,P=h,T=j,A=w;return u(),r(m,null,[d(A,{"enable-back-to-top":"","scroll-y":"",class:"viewport"},{default:o((()=>[c(" 收货地址 "),n(q)?(u(),i(g,{key:0,class:"shipment","hover-class":"none",url:"/pagesMember/address/address?from=order"},{default:o((()=>[d(l,{class:"user"},{default:o((()=>[p(f(n(q).receiver)+" "+f(n(q).contact),1)])),_:1}),d(l,{class:"address"},{default:o((()=>[p(f(n(q).fullLocation)+" "+f(n(q).address),1)])),_:1}),d(t,{class:"icon icon-right"})])),_:1})):(u(),i(g,{key:1,class:"shipment","hover-class":"none",url:"/pagesMember/address/address?from=order"},{default:o((()=>[d(l,{class:"address"},{default:o((()=>[p(" 请选择收货地址 ")])),_:1}),d(t,{class:"icon icon-right"})])),_:1})),c(" 商品信息 "),d(l,{class:"goods"},{default:o((()=>{var s;return[(u(!0),r(m,null,v(null==(s=U.value)?void 0:s.goods,(s=>(u(),i(g,{key:s.skuId,url:`/pages/goods/goods?id=${s.id}`,class:"item","hover-class":"none"},{default:o((()=>[d(b,{class:"picture",src:s.picture},null,8,["src"]),d(l,{class:"meta"},{default:o((()=>[d(l,{class:"name ellipsis"},{default:o((()=>[p(f(s.name),1)])),_:2},1024),d(l,{class:"attrs"},{default:o((()=>[p(f(s.attrsText),1)])),_:2},1024),d(l,{class:"prices"},{default:o((()=>[d(l,{class:"pay-price symbol"},{default:o((()=>[p(f(s.payPrice),1)])),_:2},1024),d(l,{class:"price symbol"},{default:o((()=>[p(f(s.price),1)])),_:2},1024)])),_:2},1024),d(l,{class:"count"},{default:o((()=>[p("x"+f(s.count),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128))]})),_:1}),c(" 配送及支付方式 "),d(l,{class:"related"},{default:o((()=>[d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("配送时间")])),_:1}),d(P,{range:D.value,"range-key":"text",onChange:S},{default:o((()=>[d(l,{class:"icon-fonts picker"},{default:o((()=>[p(f(n(O).text),1)])),_:1})])),_:1},8,["range"])])),_:1}),d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("订单备注")])),_:1}),d(T,{class:"input","cursor-spacing":30,placeholder:"选题，建议留言前先与商家沟通确认",modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=s=>$.value=s)},null,8,["modelValue"])])),_:1})])),_:1}),c(" 支付金额 "),d(l,{class:"settlement"},{default:o((()=>[d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("商品总价: ")])),_:1}),d(t,{class:"number symbol"},{default:o((()=>{var s;return[p(f(null==(s=U.value)?void 0:s.summary.totalPrice.toFixed(2)),1)]})),_:1})])),_:1}),d(l,{class:"item"},{default:o((()=>[d(t,{class:"text"},{default:o((()=>[p("运费: ")])),_:1}),d(t,{class:"number symbol"},{default:o((()=>{var s;return[p(f(null==(s=U.value)?void 0:s.summary.postFee.toFixed(2)),1)]})),_:1})])),_:1})])),_:1})])),_:1}),c(" 吸底工具栏 "),d(l,{class:"toolbar",style:y({paddingBottom:(null==(a=n(B))?void 0:a.bottom)+"px"})},{default:o((()=>{var s;return[d(l,{class:"total-pay symbol"},{default:o((()=>[d(t,{class:"number"},{default:o((()=>{var s;return[p(f(null==(s=U.value)?void 0:s.summary.totalPayPrice.toFixed(2)),1)]})),_:1})])),_:1}),d(l,{class:_(["button",{disabled:!(null==(s=n(q))?void 0:s.id)}]),onClick:z},{default:o((()=>[p(" 提交订单 ")])),_:1},8,["class"])]})),_:1},8,["style"])],64)}}}),[["__scopeId","data-v-b4d69821"]]);export{B as default};
